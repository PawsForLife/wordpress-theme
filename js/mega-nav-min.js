function coverContent(){var cover=$(document).height(),cover=$("<div>",{class:"cover"}).css({height:cover,display:"block"});$(".cover").remove(),$(cover).appendTo("body"),$(".species").hasClass("active-menu")||$(".cover").remove(),$("#main-navigation .group, .mega-nav").on("click",function(e){e.stopPropagation()}),$("#header, .cover").on("click",function(e){$(".species").removeClass("active-menu"),$(".cover").remove()})}function tracking(){$(".mega-nav .links .nav-groupings ul.ui-sub-nav a").each(function(){var self=$(this),item=self.text().trim(),category=self.parents("ul").eq(0).siblings("label").children("a").text().trim(),section=self.parents(".mega-nav").eq(0).siblings("div").find("h4").text().trim();analytics.trackLink(self,"MegaNav Click",{section:section,category:category,item:item})}),$(".right-topbar-wrapper.tiles").find("a").each(function(){var item,category,self=$(this),section=self.find("img");section&&section.length&&(item=section.attr("alt").trim(),category=self.parents("ul").eq("0").hasClass("image-tiles")?"Banners":"Shop by Life Stage",section=self.parents(".mega-nav").eq(0).siblings("div").find("h4").text().trim(),analytics.trackLink(self,"MegaNav Click",{section:section.capitalize(),category:category.capitalize(),item:item.capitalize()}))}),$(".mega-nav .links .nav-groupings > li > label a").each(function(){var self=$(this),category=self.text().trim(),section=self.parents(".mega-nav").eq(0).siblings("div").find("h4").text().trim();analytics.trackLink(self,"MegaNav Click",{section:section,category:category,item:""})}),$("#main-navigation .species > a").each(function(){var self=$(this),section=self.text().trim();analytics.trackLink(self,"MegaNav Click",{section:section,category:"",item:""})}),$("#main-navigation .link-item-menu  a").each(function(){var self=$(this),section=self.text().trim();analytics.trackLink(self,"MegaNav Click",{section:section})})}function desktopNav(){var megaNavItem=$("#main-navigation").find("ul.group li.species div.nav-link");$(megaNavItem).each(function(){$(this).on("click",function(){var species=$(this).parents("li.species");lazyload(species),species.toggleClass("active-menu").siblings().removeClass("active-menu"),coverContent()})}),tracking()}function lazyload(target){return!!target&&(target.find("img").each(function(){var self=$(this),imageSource=self.attr("src"),dataSource=self.data("src");imageSource!==dataSource&&self.attr("src",dataSource)}),this)}function mobileNav(){var menu={},overlay=$(".mobile-nav-overlay"),menuSection=$(".menu-section"),body=$("body");menu.classAdd=function(elem,className,callback){elem.addClass("section-animate"),elem.hasClass(className)||elem.addClass(className),"function"==typeof callback&&callback()},menu.transitionEnd=function(elem,callback){elem.on("transitionend",function(){elem.removeClass("section-animate"),"function"==typeof callback&&callback()})},menu.resetNavigation=function(){menuSection.add(overlay).removeClass("section-visible"),body.removeClass("mega-nav-state"),$(".cover").remove(),setTimeout(function(){$(".child-menu-container").removeClass("active"),$(".has-sub").removeClass("section-visible")},500)},overlay.on("click",function(){menu.resetNavigation()}),$(".has-sub").on("click",function(e){var self=$(this),subMenuElem=self.find(".child-menu-container"),firstChildContainer=self.find(".child-menu-container:first-child"),subMenuElem=1<subMenuElem.length?firstChildContainer:subMenuElem;menu.classAdd(self,"section-visible"),menu.classAdd(subMenuElem,"active")}),$(".back-to").on("click",function(e){e.stopPropagation(),$(this).closest(".child-menu-container").removeClass("active")}),$(".menu-btn").on("click",function(){menu.classAdd(menuSection,"section-visible",function(){menu.transitionEnd(menuSection)}),menu.classAdd(overlay,"section-visible"),menu.classAdd(body,"mega-nav-state")}),menu.resetNavigation(),tracking()}function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,callNow=immediate&&!timeout;clearTimeout(timeout),timeout=setTimeout(function(){timeout=null,immediate||func.apply(context,args)},wait),callNow&&func.apply(context,args)}}

function jsResponsive(responsiveRules,elem){$("#main-navigation").html(elem),(responsiveRules.matches?mobileNav:desktopNav)()
	//PCCart.refreshCartTotals()
}

function megaNavInit(){var originalElm=$("#main-navigation").html(),
	windowWidth=window.matchMedia("(max-width: 769px)"),
	menu=debounce(function()        {jsResponsive(windowWidth,originalElm)},250);windowWidth.addListener(menu),menu()
}